{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/purna/week06/personal-budget-final/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/purna/week06/personal-budget-final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/purna/week06/personal-budget-final/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{reactLocalStorage}from'reactjs-localstorage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Login=function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),identifier=_useState2[0],setIdentifier=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoginView=_useState6[0],setIsLoginView=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var navigate=useNavigate();var handleLoginSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var response,username,jwtToken;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return loginUser({identifier:identifier,password:password});case 4:response=_context.sent;if(response.success){username=response.data.username;jwtToken=response.data.token;reactLocalStorage.set(\"username\",username);reactLocalStorage.set(\"jwt\",jwtToken);navigate('/account');}else{setError(response.message||'Login failed');}_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.error('Login error:',_context.t0);setError('Login request failed');case 12:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}));return function handleLoginSubmit(_x){return _ref.apply(this,arguments);};}();var handleSignUpSubmit=function handleSignUpSubmit(event){event.preventDefault();navigate('/signup');};return/*#__PURE__*/_jsx(\"div\",{children:isLoginView?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLoginSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:identifier,onChange:function onChange(e){return setIdentifier(e.target.value);},placeholder:\"Username or Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},placeholder:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Login\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setIsLoginView(false);},children:\"New User? Sign Up\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Sign Up\"}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSignUpSubmit,children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Sign Up\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setIsLoginView(true);},children:\"Already have an account? Log In\"})]})});};export default Login;function loginUser(_x2){return _loginUser.apply(this,arguments);}function _loginUser(){_loginUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(credentials){var response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch('http://localhost:3031/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(credentials)});case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:data=_context2.sent;if(!response.ok){_context2.next=11;break;}return _context2.abrupt(\"return\",{success:true,data:data});case 11:return _context2.abrupt(\"return\",{success:false,message:data.error});case 12:_context2.next=18;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);console.error('Login request failed:',_context2.t0);return _context2.abrupt(\"return\",{success:false,message:'Failed to login'});case 18:case\"end\":return _context2.stop();}},_callee2,null,[[0,14]]);}));return _loginUser.apply(this,arguments);}","map":{"version":3,"names":["React","useState","useNavigate","reactLocalStorage","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","_useState","_useState2","_slicedToArray","identifier","setIdentifier","_useState3","_useState4","password","setPassword","_useState5","_useState6","isLoginView","setIsLoginView","_useState7","_useState8","error","setError","navigate","handleLoginSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","response","username","jwtToken","wrap","_callee$","_context","prev","next","preventDefault","loginUser","sent","success","data","token","set","message","t0","console","stop","_x","apply","arguments","handleSignUpSubmit","children","onSubmit","type","value","onChange","e","target","placeholder","style","color","onClick","_x2","_loginUser","_callee2","credentials","_callee2$","_context2","fetch","method","headers","body","JSON","stringify","json","ok","abrupt"],"sources":["C:/Users/purna/week06/personal-budget-final/src/login/login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { reactLocalStorage } from 'reactjs-localstorage';\r\n\r\nconst Login = () => {\r\n  const [identifier, setIdentifier] = useState(''); \r\n  const [password, setPassword] = useState('');\r\n  const [isLoginView, setIsLoginView] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const handleLoginSubmit = async (event) => {\r\n    event.preventDefault();\r\n\r\n    try {\r\n      const response = await loginUser({ identifier, password });\r\n\r\n      if (response.success) {\r\n        const username = response.data.username;\r\n        const jwtToken = response.data.token;\r\n        reactLocalStorage.set(\"username\", username);\r\n        \r\n        reactLocalStorage.set(\"jwt\", jwtToken);\r\n        navigate('/account');\r\n  \r\n\r\n      } else {\r\n        setError(response.message || 'Login failed');\r\n      }\r\n    } catch (error) {\r\n      console.error('Login error:', error);\r\n      setError('Login request failed');\r\n    }\r\n  };\r\n\r\n  const handleSignUpSubmit = (event) => {\r\n    event.preventDefault();\r\n    navigate('/signup');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {isLoginView ? (\r\n        <>\r\n          <h2>User Login</h2>\r\n          <form onSubmit={handleLoginSubmit}>\r\n            <input\r\n              type=\"text\"\r\n              value={identifier}\r\n              onChange={(e) => setIdentifier(e.target.value)}\r\n              placeholder=\"Username or Email\"\r\n            />\r\n            <input\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              placeholder=\"Password\"\r\n            />\r\n            <input type=\"submit\" value=\"Login\" />\r\n          </form>\r\n          {error && <p style={{ color: 'red' }}>{error}</p>}\r\n          <button onClick={() => setIsLoginView(false)}>New User? Sign Up</button>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <h2>User Sign Up</h2>\r\n          <form onSubmit={handleSignUpSubmit}>\r\n            {/* ... Sign Up form fields ... */}\r\n            <input type=\"submit\" value=\"Sign Up\" />\r\n          </form>\r\n          <button onClick={() => setIsLoginView(true)}>Already have an account? Log In</button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n\r\nasync function loginUser(credentials) {\r\n  try {\r\n    const response = await fetch('http://localhost:3031/login', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(credentials),\r\n    });\r\n\r\n    const data = await response.json();\r\n\r\n    if (response.ok) {\r\n      return { success: true, data };\r\n    } else {\r\n      return { success: false, message: data.error };\r\n    }\r\n  } catch (error) {\r\n    console.error('Login request failed:', error);\r\n    return { success: false, message: 'Failed to login' };\r\n  }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}